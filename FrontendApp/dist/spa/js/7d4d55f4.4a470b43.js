(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["7d4d55f4"],{"230ec":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pa-md"},[a("q-breadcrumbs",[a("q-breadcrumbs-el",{attrs:{icon:"home",to:"/Admin"}}),a("q-breadcrumbs-el",{attrs:{label:"Bank Deposit",icon:"account_balance"}}),a("q-breadcrumbs-el",{attrs:{label:"Service Transactions",icon:"list"}})],1)],1),a("div",{staticClass:"q-pa-md row"},t._l(t.data,function(t){return a("q-card",{key:t._id,staticClass:"col-xs-12 col-md-3 q-ma-sm"},[a("q-card-section",[a("ShopperEvaluation",{attrs:{paymentDetails:t}})],1)],1)}),1)])},n=[],i=a("a34a"),r=a.n(i),o=(a("7514"),a("96cf"),a("c973")),l=a.n(o),p=a("dae4"),c={components:{ShopperEvaluation:p["a"]},data:function(){return{data:[]}},mounted:function(){var t=l()(r.a.mark(function t(){var e=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$dbCon.authenticate();case 2:this.$dbCon.service("shopper-payments").onDataChange(function(){e.$dbCon.service("shopper-payments").find({query:{payment_option:"Bank Deposit","deposit_details.status":"For Approval",type:"Service"}}).then(function(t){e.data=t.data})});case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},d=c,u=a("2877"),m=Object(u["a"])(d,s,n,!1,null,null,null);e["default"]=m.exports},"6cdf":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-btn",{staticClass:"q-pb-md",attrs:{icon:"history",label:"view payment schedules",flat:"",color:"black",size:"md"},on:{click:function(e){t.opened=!0}}}),a("q-dialog",{model:{value:t.opened,callback:function(e){t.opened=e},expression:"opened"}},[a("q-card",{staticStyle:{width:"600px"}},[a("q-card-section",{staticClass:"text-h6 text-white bg-primary"},[a("div",[t._v("Payment Schedules")])]),a("q-separator"),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"70vh"}},[a("q-list",{attrs:{bordered:"",separator:""}},t._l(t.schedules,function(e){return a("q-item",{key:e},[a("q-item-section",[a("q-item-label",{staticClass:"text-bold"},[t._v("Schedule: "+t._s(t.$formatDate_DateOnly(e.schedule)))]),a("q-item-label",{attrs:{caption:""}},[t._v("Amount: "+t._s(t.$prettyMoney(e.amount)))]),a("q-item-label",{attrs:{caption:""}},[t._v("Status: "),a("span",{class:"Pending"==e.status?"text-grey":"text-green"},[t._v(t._s("Pending"==e.status?"Pending":"Paid"))])])],1)],1)}),1)],1),a("q-separator"),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"Close",color:"grey"},on:{click:function(e){t.opened=!1}}})],1)],1)],1)],1)},n=[],i={props:{schedules:Object},data:function(){return{opened:!1}}},r=i,o=a("2877"),l=Object(o["a"])(r,s,n,!1,null,null,null);e["a"]=l.exports},dae4:function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"q-pb-sm"},[a("b",{staticClass:"text-orange"},[t._v(t._s("Product"==t.paymentDetails.type?"Order":"Reservation")+"#"+t._s(t.transaction.order_number))]),a("br"),a("b",[t._v("Shopper:")]),t._v("\n    "+t._s(t.shopper.fname+" "+t.shopper.lname)+"\n    "),a("br"),a("b",[t._v("Total:")]),t._v("\n    "+t._s(t.$prettyMoney(t.paymentDetails.total))+"\n  ")]),a("div",{attrs:{align:"right"}},[a("q-btn",{attrs:{label:"evaluate",unelevated:"",color:"primary"},on:{click:function(e){t.opened=!0}}})],1),a("q-dialog",{model:{value:t.opened,callback:function(e){t.opened=e},expression:"opened"}},[a("q-card",[a("q-card-section",{staticClass:"bg-primary text-white"},[a("div",{staticClass:"text-h6"},[t._v("Evaluate Uploaded Bank Deposit")])]),a("q-separator"),a("q-card-section",{staticClass:"scroll",staticStyle:{"max-height":"50vh"}},[a("div",[a("div",{staticClass:"text-h6"},[t._v("Shopper Details")]),a("q-separator"),a("b",[t._v("Name:")]),t._v("\n          "+t._s(t.shopper.fname+" "+t.shopper.lname)+"\n          "),a("br"),a("b",[t._v("Mobile Number:")]),t._v("\n          "+t._s(t.shopper.mobile_number)+"\n          "),a("br"),a("b",[t._v("Email Address:")]),t._v("\n          "+t._s(t.shopper.email)+"\n          "),a("br")],1),a("br"),a("div",[a("div",{staticClass:"text-h6"},[t._v(t._s("Product"==t.paymentDetails.type?"Order":"Reservation")+" Details")]),a("q-separator"),"Product"==t.paymentDetails.type?a("ProductDetails",{attrs:{order:t.transaction,buttonVisible:!1}}):a("ServiceDetails",{attrs:{order:t.transaction,buttonVisible:!1}})],1),a("div",{staticClass:"q-pa-sm"},[a("div",{staticClass:"text-h6"},[t._v("Deposit Slip")]),a("q-separator"),a("br"),"Full Payment"!=t.paymentDetails.payment_type?a("div",{attrs:{align:"right"}},[a("PaymentSchedules",{attrs:{schedules:t.paymentDetails.recurring_payments}})],1):t._e(),a("q-list",{staticClass:"rounded-borders",attrs:{padding:"",bordered:""}},t._l(t.paymentDetails.deposit_details,function(e,s){return a("q-expansion-item",{key:s,attrs:{group:"somegroup",dense:"","default-opened":0==s,"dense-toggle":"","expand-separator":"",label:t.$formatDate_DateOnly(e.date_uploaded)}},[a("q-card",[a("q-card-section",[a("q-img",{attrs:{ratio:16/9,src:e.path}}),a("div",{attrs:{align:"right"}},[a("a",{attrs:{href:e.path,target:"_blank"}},[a("q-btn",{attrs:{unelevated:"",color:"primary",icon:"remove_red_eye",label:"view",outline:"",dense:"",size:"sm"}})],1),t._v(" Â \n                    "),a("a",{attrs:{href:e.path,target:"_blank"}},[a("q-btn",{attrs:{unelevated:"",color:"primary",icon:"get_app",label:"download",outline:"",dense:"",size:"sm"}})],1)]),a("div",[a("b",[t._v("Reference Number:")]),t._v("\n                      "+t._s(e.reference_number)+"\n                    ")]),a("div",[a("b",[t._v("Total Amount:")]),t._v("\n                      "+t._s(t.$prettyMoney(e.total_amount))+"\n                    ")]),a("div",[a("b",[t._v("Date Deposited:")]),t._v("\n                      "+t._s(e.date_deposited)+"\n                    ")]),a("div",[a("b",[t._v("Shopper Remarks:")]),t._v("\n                    "+t._s(e.remarks)+"\n                  ")]),0!=s?a("div",[a("b",[t._v("Comments:")]),t._v("\n                    "+t._s(e.comments)+"\n                  ")]):t._e()],1)],1)],1)}),1)],1)]),a("q-separator"),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{flat:"",label:"Disapprove",color:"grey"},on:{click:t.disapprove}}),a("q-btn",{attrs:{flat:"",label:"Approve",color:"primary"},on:{click:t.approve}})],1)],1)],1)],1)},n=[],i=a("a34a"),r=a.n(i),o=(a("96cf"),a("c973")),l=a.n(o),p=a("6cdf"),c=a("2234"),d=a("2b67"),u={props:["paymentDetails"],components:{PaymentSchedules:p["a"],ProductDetails:c["a"],ServiceDetails:d["a"]},data:function(){return{opened:!1,transaction:{},shopper:{},reference_number:"",total_amount:0,date_deposited:""}},methods:{approve:function(){var t=this;this.$q.dialog({title:"Payment Approval",message:"Are you sure you want to approve this payment?",cancel:{push:!0,color:"grey",flat:!0}}).onOk(function(){t.paymentDetails.deposit_details[t.paymentDetails.deposit_details.length-1].status="Approved",t.paymentDetails.deposit_details[t.paymentDetails.deposit_details.length-1].reference_number=t.reference_number,t.paymentDetails.deposit_details[t.paymentDetails.deposit_details.length-1].total_amount=t.total_amount,t.paymentDetails.deposit_details[t.paymentDetails.deposit_details.length-1].date_deposited=t.date_deposited,t.paymentDetails.deposit_details[t.paymentDetails.deposit_details.length-1].date_reviewed=new Date,t.$dbCon.service("shopper-payments").patch(t.paymentDetails._id,t.paymentDetails).then(function(){t.updateProductTransaction(),t.opened=!1})})},updateProductTransaction:function(){var t=l()(r.a.mark(function t(){var e,a;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if("Full Payment"!=this.paymentDetails.payment_type){t.next=12;break}if(this.transaction.status="For Acknowledgement","Product"!=this.paymentDetails.type){t.next=7;break}return t.next=5,this.$dbCon.service("product-transactions").patch(this.transaction._id,this.transaction);case 5:t.next=10;break;case 7:if("Service"!=this.paymentDetails.type){t.next=10;break}return t.next=10,this.$dbCon.service("service-transactions").patch(this.transaction._id,this.transaction);case 10:t.next=36;break;case 12:if("20% Downpayment"!=this.paymentDetails.payment_type&&"Layaway"!=this.paymentDetails.payment_type){t.next=36;break}e=0;case 14:if(!(e<this.paymentDetails.recurring_payments.length)){t.next=36;break}if(a=this.paymentDetails.recurring_payments[e],"Pending"!=a.status){t.next=33;break}if(a.status="Done",e!=this.paymentDetails.recurring_payments.length-1){t.next=29;break}if(this.transaction.status="For Acknowledgement",this.paymentDetails.status="Done","Product"!=this.paymentDetails.type){t.next=26;break}return t.next=24,this.$dbCon.service("product-transactions").patch(this.transaction._id,this.transaction);case 24:t.next=29;break;case 26:if("Service"!=this.paymentDetails.type){t.next=29;break}return t.next=29,this.$dbCon.service("service-transactions").patch(this.transaction._id,this.transaction);case 29:return this.paymentDetails.recurring_payments[e]=a,t.next=32,this.$dbCon.service("shopper-payments").patch(this.paymentDetails._id,this.paymentDetails);case 32:return t.abrupt("break",36);case 33:e++,t.next=14;break;case 36:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),disapprove:function(){var t=this;this.$q.dialog({title:"Payment Disapproval",message:"Are you sure you want to disapprove this payment?",cancel:{push:!0,color:"grey",flat:!0}}).onOk(function(){t.paymentDetails.deposit_details[t.paymentDetails.deposit_details.length-1].status="Disapprove",t.paymentDetails.deposit_details[t.paymentDetails.deposit_details.length-1].date_reviewed=new Date,t.$dbCon.service("shopper-payments").patch(t.paymentDetails._id,t.paymentDetails).then(function(){t.opened=!1})})}},mounted:function(){var t=l()(r.a.mark(function t(){var e=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$dbCon.service("users").get(this.paymentDetails.shopper_id);case 2:this.shopper=t.sent,"Product"==this.paymentDetails.type?this.$dbCon.service("product-transactions").get(this.paymentDetails.related_id).then(function(t){e.transaction=t}):"Service"==this.paymentDetails.type&&this.$dbCon.service("service-transactions").get(this.paymentDetails.related_id).then(function(t){e.transaction=t});case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},m=u,h=a("2877"),v=Object(h["a"])(m,s,n,!1,null,null,null);e["a"]=v.exports}}]);