(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["236cbbba"],{"0fda":function(e,t,i){"use strict";var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"row"},[i("div",{directives:[{name:"show",rawName:"v-show",value:2==e.step,expression:"step==2"}],staticClass:"col-md-12 col-sm-12 row"},[i("q-input",{ref:"inp_sku",staticClass:"col-md-12 col-xs-12 q-pt-sm",attrs:{dense:"",stack:"",label:"Stock Keeping Unit(SKU)",rules:[function(e){return""!=e.trim()||"Required"}]},model:{value:e.SKU,callback:function(t){e.SKU=t},expression:"SKU"}}),i("q-input",{ref:"inp_service_name",staticClass:"col-12 q-pt-sm",attrs:{dense:"",stack:"",label:"Service Name",maxlength:60,rules:[function(e){return""!=e.trim()||"Required"}],"lazy-rules":"",counter:""},model:{value:e.service_name,callback:function(t){e.service_name=t},expression:"service_name"}}),i("p",{staticClass:"text-title text-black"},[e._v("Description:")]),i("div",{staticClass:"col-12 q-pt-sm"},[i("q-editor",{ref:"inp_description",style:e.description_error?"border:solid red 1px":"",attrs:{"min-height":"4rem"},on:{input:function(){return e.validateDescription()}},model:{value:e.description,callback:function(t){e.description=t},expression:"description"}}),e.description_error?e._e():i("div",{attrs:{align:"right"}},[i("small",{staticClass:"text-grey"},[e._v(e._s(e.description_counter)+" / 1000 words")])]),e.description_error?i("small",{staticClass:"text-red"},[e._v(e._s(e.description_error_message))]):e._e()],1),i("q-input",{ref:"inp_regular_price",staticClass:"col-6 q-pt-sm q-pr-sm",attrs:{dense:"",stack:"",label:"Regular Price",rules:[function(t){return e.temp_regular_price>0||"Invalid Regular Price"},function(e){return""!=e.trim()||"Required"}],"lazy-rules":""},on:{focus:e.toInputRegularPrice,blur:e.toChangeRegularPrice},model:{value:e.regular_price,callback:function(t){e.regular_price=t},expression:"regular_price"}}),i("q-input",{staticClass:"col-6 q-pt-sm q-pr-sm",attrs:{dense:"",stack:"",label:"Sale Price","error-message":"Invalid Sale Price",error:e.sale_price_error,rules:[]},on:{focus:e.toInputSalePrice,blur:e.toChangeSalePrice},model:{value:e.sale_price,callback:function(t){e.sale_price=t},expression:"sale_price"}})],1),i("input",{ref:"fileInput0",staticClass:"col-12 hidden",attrs:{type:"file",multiple:""},on:{change:e.onImageSelected0}}),i("input",{ref:"fileInput1",staticClass:"col-12 hidden",attrs:{type:"file"},on:{change:e.onImageSelected1}}),i("input",{ref:"fileInput2",staticClass:"col-12 hidden",attrs:{type:"file"},on:{change:e.onImageSelected2}}),i("input",{ref:"fileInput3",staticClass:"col-12 hidden",attrs:{type:"file"},on:{change:e.onImageSelected3}}),i("br"),i("div",{directives:[{name:"show",rawName:"v-show",value:3==e.step,expression:"step==3"}],staticClass:"row flex q-gutter-md justify-center",attrs:{align:"center"}},e._l([0,1,2,3],function(t){return i("q-card",{key:t,staticStyle:{"min-width":"154px","max-width":"154px","min-height":"152px","max-height":"152px",cursor:"pointer",overflow:"hidden"},style:e.validation[3+t]?"":"border-color:red",attrs:{flat:"",bordered:""},on:{mouseover:function(i){e.currentPic=t},mouseleave:function(t){e.currentPic=-1}}},[0==e.fileSelected[t].length?i("q-card-section",[i("br"),i("br"),i("q-btn",{attrs:{icon:"add",color:"primary",round:"",unelevated:""},on:{click:function(i){e.currentPic=-1,e.$refs["fileInput"+t].click()}}})],1):e._e(),e.currentPic==t?i("q-card-section",[i("br"),i("br"),i("q-btn",{attrs:{icon:"edit",color:"primary",round:"",unelevated:""},on:{click:function(i){e.currentPic=-1,e.$refs["fileInput"+t].click()}}}),e._v(" \n        "),i("q-btn",{attrs:{icon:"delete",color:"red",round:"",unelevated:""},on:{click:function(i){e.currentPic=-1,e.fileSelected[t]=[]}}})],1):e._e(),e.currentPic!=t?i("img",{directives:[{name:"show",rawName:"v-show",value:0!=e.fileSelected[t].length,expression:"fileSelected[i].length!=0"}],attrs:{src:e.photoUrl[t],width:"100%",height:"100%"}}):e._e()],1)}),1),i("div",{directives:[{name:"show",rawName:"v-show",value:4==e.step,expression:"step==4"}],staticClass:"col-12"},[i("div",{staticClass:"col-12 text-title text-black text-bold"},[e._v("Payment Method")]),i("div",{staticClass:"col-12 q-pt-sm row items-center"},[i("div",{staticClass:"col-11 text-title text-grey"},[e._v("Online Debit/Credit Card (default)")]),i("q-radio",{staticClass:"col-1",attrs:{active:!0,readonly:""}})],1),i("div",{staticClass:"col-12 q-pt-sm row items-center"},[i("div",{staticClass:"col-11 text-title text-grey"},[e._v("Bank Deposit/Wire Transfer (default)")]),i("q-radio",{staticClass:"col-1",attrs:{active:!0,readonly:""}})],1),i("div",{staticClass:"col-12 q-pt-sm text-title text-black text-bold"},[e._v("Other Flexible Options for Your Clients")]),i("div",{staticClass:"col-12 row items-center"},[i("div",{staticClass:"col-11 text-title text-grey"},[e._v("Enable Cash on Fulfillment?")]),i("q-checkbox",{staticClass:"col-1",model:{value:e.cof,callback:function(t){e.cof=t},expression:"cof"}})],1),i("div",{staticClass:"col-12 row items-center"},[i("div",{staticClass:"col-11 text-title text-grey"},[e._v("\n        Enable Layaway?\n        "),i("q-btn",{attrs:{color:"grey",size:"sm",round:"",flat:"",icon:"help"}},[i("q-popup-proxy",[i("q-banner",[i("div",{staticClass:"text-bold"},[e._v("What is Layaway?")]),e._v("a system of paying a deposit to secure an item for later purchase.\n            ")])],1)],1)],1),i("q-checkbox",{staticClass:"col-1",model:{value:e.lay_away,callback:function(t){e.lay_away=t},expression:"lay_away"}})],1),i("div",{staticClass:"col-12 text-title text-black text-bold"},[e._v("Others")]),i("div",{staticClass:"col-12 row items-center"},[i("div",{staticClass:"col-11 text-title text-grey"},[e._v("Require 20% downpayment upon booking if Cash on Fulfillment?")]),i("q-checkbox",{staticClass:"col-1",model:{value:e.dp_cof,callback:function(t){e.dp_cof=t},expression:"dp_cof"}})],1)])])},a=[],s=(i("7f7f"),i("6762"),i("2fdb"),i("a34a")),n=i.n(s),c=(i("7514"),i("96cf"),i("c973")),o=i.n(c),l=(i("5df3"),i("1c4c"),{props:["step","category"],data:function(){return{currentPic:-1,opened:!1,category:"",category_options:[],SKU:"",service_name:"",description:"",regular_price:"",temp_regular_price:"",sale_price:"",temp_sale_price:null,cof:!0,lay_away:!0,dp_cof:!0,fileSelected:[[],[],[],[]],photoUrl:["","","",""],validation:[],sale_price_error:!1,description_error:!1,description_error_message:"",description_counter:0}},methods:{onImageSelected0:function(e){var t=this;Array.from(e.target.files).map(function(i,r){t.photoUrl[r]=URL.createObjectURL(e.target.files[r]),t.$forceUpdate(),t.fileSelected[r]=e.target.files[r],t.$forceUpdate()})},onImageSelected1:function(e){this.photoUrl[1]=URL.createObjectURL(e.target.files[0]),this.$forceUpdate(),this.fileSelected[1]=e.target.files[0],this.$forceUpdate()},onImageSelected2:function(e){this.photoUrl[2]=URL.createObjectURL(e.target.files[0]),this.$forceUpdate(),this.fileSelected[2]=e.target.files[0],this.$forceUpdate()},onImageSelected3:function(e){this.photoUrl[3]=URL.createObjectURL(e.target.files[0]),this.$forceUpdate(),this.fileSelected[3]=e.target.files[0],this.$forceUpdate()},save:function(){var e=o()(n.a.mark(function e(){var t,i,r=this;return n.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.$q.loading.show(),t=[],e.next=4,this.uploadImage(this.fileSelected[0]);case 4:return t[0]=e.sent,e.next=7,this.uploadImage(this.fileSelected[1]);case 7:return t[1]=e.sent,e.next=10,this.uploadImage(this.fileSelected[2]);case 10:return t[2]=e.sent,e.next=13,this.uploadImage(this.fileSelected[3]);case 13:return t[3]=e.sent,console.log(t),e.next=17,this.$dbCon.service("service-subscriptions").find({query:{store_id:this.$local.getItem("store_token"),$or:[{date_end:{$gte:new Date},status:"Paid"},{status:"Free"}],$sort:{date_ordered:-1}}}).then(function(e){return 0==e.data.length?"":"Free"==e.data[0].status?"":"Paid"==e.data[0].status?e.data[0].date_end:void 0});case 17:i=e.sent,this.$dbCon.service("services").create({store_id:this.$local.getItem("store_token"),category:this.category,SKU:this.SKU,service_name:this.service_name,description:this.description,regular_price:this.temp_regular_price,sale_price:this.temp_sale_price,cof:this.cof,lay_away:this.lay_away,deleted:!1,photos:t,expiry:i,logs:[{event:"added",date:new Date}],createdAt:new Date}).then(function(){r.$q.loading.hide(),r.opened=!1,r.$q.dialog({title:"Success!",message:"You successfully added a service."})}),this.$EventBus.$emit("update-step",6);case 20:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),validate:function(){var e=o()(n.a.mark(function e(){return n.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.validation=[],2!=this.step){e.next=15;break}return e.next=4,this.$refs.inp_service_name.validate();case 4:return this.validation[0]=e.sent,e.next=7,this.$refs.inp_regular_price.validate();case 7:return this.validation[1]=e.sent,e.next=10,this.$refs.inp_sku.validate();case 10:return this.validation[2]=e.sent,this.validateDescription(),this.description_error&&(this.validation[3]=!1),parseFloat(this.temp_regular_price)<=parseFloat(this.temp_sale_price)?(this.sale_price_error=!0,this.validation[4]=!1):parseFloat(this.temp_sale_price)<1?(this.sale_price_error=!0,this.validation[4]=!1):this.sale_price_error=!1,e.abrupt("return",this.validation.includes(!1));case 15:if(3!=this.step){e.next=21;break}return this.validation[3]=0!=this.fileSelected[0].length,this.validation[4]=0!=this.fileSelected[1].length,this.validation[5]=0!=this.fileSelected[2].length,this.validation[6]=0!=this.fileSelected[3].length,e.abrupt("return",this.validation.includes(!1));case 21:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),uploadImage:function(){var e=o()(n.a.mark(function e(t){var i,r;return n.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return i=new FormData,i.append(this.$appLink,t,t.name),e.next=4,this.$axios.post(this.$appLink+"/uploadServices",i);case 4:return r=e.sent,e.abrupt("return",r.data);case 6:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),toInputRegularPrice:function(){this.regular_price=this.temp_regular_price},toChangeRegularPrice:function(){this.temp_regular_price=this.regular_price,this.regular_price=this.$prettyMoney(this.regular_price)},toInputSalePrice:function(){this.sale_price=this.temp_sale_price},toChangeSalePrice:function(){this.temp_sale_price=this.sale_price,this.sale_price=this.$prettyMoney(this.sale_price)},validateDescription:function(){if(""==this.$sanitize(this.description).trim())return this.description_error=!0,void(this.description_error_message="This field is required.");this.description_error=!1,this.description_counter=this.$wordsCount(this.$sanitize(this.description).trim()),this.description_counter>1e3?(this.description_error=!0,this.description_error_message="Maximum of 1000 words only."):this.description_error=!1}},watch:{step:function(){5==this.step&&this.save()}},mounted:function(){var e=this;this.$dbCon.service("store").onDataChange(function(){e.category_options=[],e.$dbCon.service("store").get(e.$local.getItem("store_token")).then(function(t){e.$dbCon.service("categories").find({query:{category_name:{$in:t.categories},classification:"Service"}}).then(function(t){t.data.map(function(t){e.category_options.push(t.category_name)})})})})}}),d=l,u=i("2877"),p=Object(u["a"])(d,r,a,!1,null,null,null);t["a"]=p.exports},2732:function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"q-pa-md"},["/StoreOwner/PublishStore"!=e.$route.path?i("q-breadcrumbs",{staticClass:"text-grey"},[i("q-breadcrumbs-el",{attrs:{label:"Store",icon:"store"}}),i("q-breadcrumbs-el",{attrs:{label:"Inventory",icon:"inventory"}}),i("q-breadcrumbs-el",{attrs:{label:"Services"}})],1):e._e(),i("br"),i("div",{staticClass:"bg-grey-3"},[i("q-toolbar",[e.maximum_services>e.data.length?i("AddService"):i("AddMoreItem",{attrs:{itemtype:"Services"}}),e._v(" \n      "),i("q-space"),"/StoreOwner/PublishStore"!=e.$route.path?i("q-input",{attrs:{square:"",outlined:"",dense:"",debounce:"300",placeholder:"Search"},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{attrs:{name:"search"}})]},proxy:!0}],null,!1,4009527860),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}}):e._e()],1),i("q-separator"),i("q-toolbar",[i("p",{staticClass:"text-bold"},[i("br"),e._v("\n        Maximum Items: "+e._s(e.maximum_services)+"\n        "),i("br"),e._v("\n        Current Items: "+e._s(e.data.length)+"\n      ")])])],1),i("q-table",{attrs:{data:e.data,columns:e.columns,"row-key":"name",filter:e.filter,grid:"","hide-header":""},scopedSlots:e._u([{key:"item",fn:function(t){return[i("div",{staticClass:"q-pa-xs col-xs-12 col-md-4 col-lg-3"},[i("q-card",[i("q-img",{staticStyle:{width:"100%",height:"150px"},attrs:{src:t.row.photos[0]}}),"past"!=e.$compareToCurrentDate(t.row.expiry)?i("AdvertiseButton",{attrs:{related_id:t.row._id,item_type:"service"}}):i("q-btn",{staticClass:"absolute",staticStyle:{top:"0",right:"12px",transform:"translateY(300%)"},attrs:{label:"Expired",icon:"info",color:"red"},on:{click:e.unavailableMessage}}),i("q-separator"),i("q-list",{attrs:{dense:""}},e._l(t.cols.filter(function(e){return"desc"!==e.name}),function(t){return i("q-item",{key:t.name},[i("q-item-section",[i("q-item-label",[e._v(e._s(t.label))])],1),i("q-item-section",{attrs:{side:""}},[i("q-item-label",{attrs:{caption:""}},[e._v(e._s(t.value))])],1)],1)}),1),i("q-card-actions",{attrs:{align:"around"}},[i("q-btn",{staticClass:"full-width",attrs:{color:"primary",flat:"",label:"Manage"},on:{click:function(i){return e.$router.push("Services/ManageService?service="+t.row._id)}}})],1)],1)],1)]}}])})],1)},a=[],s=(i("7514"),i("0fda")),n=i("6356"),c=i("c078"),o={components:{AddService:s["a"],AdvertiseButton:n["a"],AddMoreItem:c["a"]},data:function(){return{data:[],filter:"",columns:[{name:"SKU",required:!0,label:"SKU",align:"left",field:"SKU"},{name:"service_name",required:!0,label:"Service Name",align:"left",field:"service_name"},{name:"category",align:"center",label:"Category",field:"category"},{name:"regular_price",label:"Regular Price",field:"regular_price"},{name:"sale_price",label:"Sale Price",field:"sale_price"}],maximum_services:0}},methods:{max_service:function(){this.$q.dialog({title:"Maximum number of Services reached!",message:"To add more service, you may avail it via Bank Deposit or Layaway"})},getData:function(){var e=this;this.$dbCon.service("services").find({query:{store_id:this.$local.getItem("store_token"),deleted:!1}}).then(function(t){e.data=t.data})},advertise:function(){this.$q.dialog({title:"Alert",message:"Not yet working"})},unavailableMessage:function(){this.$q.dialog({title:"Unavailable Item",message:"This item is no longer available due to expired item subscription. You may reactivate this item again by purchasing a subscription."})}},mounted:function(){var e=this;this.$dbCon.service("services").onDataChange(function(){e.getData()}),this.$dbCon.service("service-subscriptions").onDataChange(function(){e.getData()}),this.$dbCon.service("service-subscriptions").find({query:{store_id:this.$local.getItem("store_token"),$or:[{date_end:{$gte:new Date},status:"Paid"},{status:"Free"}]}}).then(function(t){var i=0;t.data.map(function(e){i+=e.items}),e.maximum_services=i})}},l=o,d=i("2877"),u=Object(d["a"])(l,r,a,!1,null,null,null);t["default"]=u.exports}}]);