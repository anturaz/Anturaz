(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["7d447762"],{"06a3":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-btn",{attrs:{label:"PAY NOW",color:"primary"},on:{click:function(e){t.toPay=!0}}}),a("q-dialog",{attrs:{persistent:""},model:{value:t.toPay,callback:function(e){t.toPay=e},expression:"toPay"}},[a("q-card",{staticStyle:{width:"600px"}},[a("q-card-section",{staticClass:"bg-primary"},[a("div",{staticClass:"text-h6 text-white"},[t._v("PAYMENT INFORMATION")])]),a("q-separator"),a("q-card-section",[a("form",{ref:"paymentWidget",staticClass:"paymentWidgets",attrs:{action:t.currentLink,"data-brands":"VISA MASTER AMEX"}})]),a("q-separator"),a("q-card-actions",{attrs:{align:"right"}},[a("q-btn",{attrs:{label:"cancel",flat:""},on:{click:function(e){t.toPay=!1}}})],1)],1)],1)],1)},i=[],s=a("a34a"),r=a.n(s),o=(a("4917"),a("96cf"),a("c973")),c=a.n(o),l={props:{onlinePaymentResult:{type:Function},preparePayment:{type:Function}},data:function(){return{currentLink:window.location.href,toPay:!1,payment:{}}},methods:{setLoaded:function(){this.$q.loading.hide()}},watch:{"$route.query":function(){var t=c()(r.a.mark(function t(){var e,a,n=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!("id"in this.$route.query&&"resourcePath"in this.$route.query)){t.next=8;break}return this.$q.loading.show(),e=this.$route.query.id,a=this.$route.query.resourcePath,this.toPay=!1,this.$router.push(this.$route.path),t.next=8,this.$axios.get(this.$appLink+"/paymentResult?id="+e+"&resourcePath="+a).then(function(t){var e=/^(000\.000\.|000\.100\.1|000\.[36])/,a=t.data.result.code.match(e);try{0!=a.length?(n.onlinePaymentResult("success",t.data),n.$q.loading.hide()):(n.onlinePaymentResult("error",t.data),n.$q.loading.hide())}catch(i){n.onlinePaymentResult("error",t.data),n.$q.loading.hide()}});case 8:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),toPay:function(){var t=c()(r.a.mark(function t(){var e,a=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(1!=this.toPay){t.next=9;break}return t.next=3,this.preparePayment();case 3:this.payment=t.sent,this.$q.loading.show(),t.next=7;break;case 7:e=document.createElement("script"),this.$axios.post(this.$appLink+"/createCheckOutShopper",{payment:this.payment}).then(function(){var t=c()(r.a.mark(function t(n){return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.src="https://test.oppwa.com/v1/paymentWidgets.js?checkoutId=".concat(n.data.id),e.addEventListener("load",a.setLoaded),document.body.appendChild(e);case 3:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}());case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},p=l,d=a("2877"),u=Object(d["a"])(p,n,i,!1,null,null,null);e["a"]=u.exports},"2b67":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("q-item",[a("q-item-section",{attrs:{avatar:""}},[a("q-avatar",{attrs:{size:"100px",square:""}},[a("img",{attrs:{ratio:1,src:t.product.photos[0]}})])],1),a("q-item-section",[a("q-item-label",{staticClass:"text-title",attrs:{lines:"1"}},[t._v(t._s(t.product.service_name))]),a("q-item-label",{attrs:{caption:"",lines:"2"}},[a("span",{staticClass:"text-weight-bold"},[t._v("Category:")]),t._v("\n        "+t._s(t.product.category)+"\n      ")]),a("q-item-label",{attrs:{caption:"",lines:"2"}},[a("span",{staticClass:"text-weight-bold"},[t._v("Date Needed:")]),t._v("\n        "+t._s(t.$formatDate_DateOnly(t.order.date_needed))+"\n      ")]),void 0!=t.order.mode_of_delivery?a("q-item-label",{attrs:{caption:"",lines:"2"}},[a("span",{staticClass:"text-weight-bold"},[t._v("Mode of Delivery:")]),t._v("\n        "+t._s(t.order.mode_of_delivery)+"\n      ")]):t._e()],1),a("q-item-section",{attrs:{side:"",top:""}},[void 0!=t.order.order_number?a("span",{staticClass:"text-primary text-title text-bold"},[t._v("RESERVATION# "+t._s(t.order.order_number)+" ")]):t._e(),a("div",[a("span",{staticClass:"text-primary text-title text-bold"},[t._v(t._s(t.$prettyMoney(t.payment.total))+" ")])]),a("div",[t._v("Qty "+t._s(t.order.quantity))]),a("q-space"),a("div",[t.buttonVisible?a("q-btn",{attrs:{label:t.buttonLabel,color:"primary",unelevated:""},on:{click:t.updateFunction}}):t._e()],1)],1)],1)],1)},i=[],s=(a("7514"),{props:{order:Object,updateFunction:Function,buttonLabel:String,buttonVisible:Boolean},data:function(){return{product:{},shopper:{},payment:{}}},mounted:function(){var t=this;this.$dbCon.service("services").get(this.order.item_id).then(function(e){t.product=e}),this.$dbCon.service("users").get(this.order.shopper_id).then(function(e){t.shopper=e}),this.$dbCon.service("shopper-payments").find({query:{related_id:this.order._id}}).then(function(e){console.log(e),t.payment=e.data[0]})}}),r=s,o=a("2877"),c=Object(o["a"])(r,n,i,!1,null,null,null);e["a"]=c.exports},ee27:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row justify-center q-pa-md"},[a("div",{staticClass:"col-12"},[a("q-breadcrumbs",{staticClass:"q-pb-md text-primary",scopedSlots:t._u([{key:"separator",fn:function(){return[a("q-icon",{attrs:{size:"1.5em",name:"chevron_right",color:"primary"}})]},proxy:!0}])},[a("q-breadcrumbs-el",{attrs:{label:"Home",icon:"home",to:"/"}}),a("q-breadcrumbs-el",{attrs:{label:"Reservation",icon:"menu_book",to:"/ServiceDetails/"+t.service._id}}),a("q-breadcrumbs-el",{attrs:{label:"Checkout"}})],1),a("q-separator")],1),a("q-stepper",{staticClass:"col-8 col-md-8",attrs:{flat:"",vertical:"",color:"primary",animated:""},model:{value:t.step,callback:function(e){t.step=e},expression:"step"}},[a("q-step",{attrs:{name:1,title:"Set Meeting Details",done:t.step>1}},[a("q-stepper-navigation",[a("div",[a("q-card",{attrs:{flat:"",bordered:""}},[a("q-card-section",[a("div",{staticClass:"text-title text-bold"},[t._v("Meeting Place")])]),a("q-separator",{attrs:{inset:""}}),a("q-card-section",[a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-sm-12 col-md-4 q-pa-xs",attrs:{outlined:"",square:"",dense:"",label:"House/ Building No./ Street"},model:{value:t.house_bldg_st,callback:function(e){t.house_bldg_st=e},expression:"house_bldg_st"}}),a("q-input",{staticClass:"col-sm-12 col-md-4 q-pa-xs",attrs:{outlined:"",square:"",dense:"",label:"Barangay/ District"},model:{value:t.barangay_district,callback:function(e){t.barangay_district=e},expression:"barangay_district"}}),a("q-select",{staticClass:"col-sm-12 col-md-4 q-pa-xs",staticStyle:{"min-width":"200px"},attrs:{outlined:"",square:"",dense:"",options:t.store.market_areas,label:"City/Municipality"},model:{value:t.city_municipality,callback:function(e){t.city_municipality=e},expression:"city_municipality"}})],1),a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-sm-12 col-md-4 q-pa-xs",attrs:{outlined:"",square:"",dense:"",label:"State/Province"},model:{value:t.state_province,callback:function(e){t.state_province=e},expression:"state_province"}}),a("q-input",{staticClass:"col-sm-12 col-md-4 q-pa-xs",attrs:{outlined:"",square:"",dense:"",label:"Zip Code"},model:{value:t.zip_code,callback:function(e){t.zip_code=e},expression:"zip_code"}}),a("q-input",{staticClass:"col-sm-12 col-md-4 q-pa-xs",attrs:{outlined:"",square:"",dense:"",readonly:"",label:"Country"},model:{value:t.country,callback:function(e){t.country=e},expression:"country"}})],1)]),a("q-card-section",[a("div",{staticClass:"text-title text-bold"},[t._v("Primary Contact Person")])]),a("q-separator",{attrs:{inset:""}}),a("q-card-section",[a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-sm-12 col-md-6 q-pa-xs",attrs:{outlined:"",square:"",dense:"",label:"Primary Person Name"},model:{value:t.primary_person_name,callback:function(e){t.primary_person_name=e},expression:"primary_person_name"}}),a("q-input",{staticClass:"col-sm-12 col-md-6 q-pa-xs",attrs:{outlined:"",square:"",dense:"",label:"Contact Number"},model:{value:t.primary_contact_number,callback:function(e){t.primary_contact_number=e},expression:"primary_contact_number"}})],1)]),a("q-card-section",[a("div",{staticClass:"text-title text-bold"},[t._v("Secondary Contact Person")])]),a("q-separator",{attrs:{inset:""}}),a("q-card-section",[a("div",{staticClass:"row"},[a("q-input",{staticClass:"col-sm-12 col-md-6 q-pa-xs",attrs:{outlined:"",square:"",dense:"",label:"Secondary Person Name"},model:{value:t.secondary_person_name,callback:function(e){t.secondary_person_name=e},expression:"secondary_person_name"}}),a("q-input",{staticClass:"col-sm-12 col-md-6 q-pa-xs",attrs:{outlined:"",square:"",dense:"",label:"Contact Number"},model:{value:t.secondary_contact_number,callback:function(e){t.secondary_contact_number=e},expression:"secondary_contact_number"}})],1)])],1)],1),a("br"),a("div",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"Continue"},on:{click:function(e){t.step=2}}})],1)])],1),a("q-step",{attrs:{name:2,title:"Review Order",icon:"pageview",done:t.step>2}},[a("ServiceDetails",{attrs:{order:t.cart,buttonVisible:!1}}),a("q-stepper-navigation",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"Continue"},on:{click:function(e){t.step=3}}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{flat:"",color:"primary",label:"Back"},on:{click:function(e){t.step=1}}})],1)],1),a("q-step",{attrs:{name:3,title:"Payment",icon:"account_balance_wallet",done:t.step>3}},[a("q-tabs",{attrs:{dense:"",align:"left","no-caps":"","inline-label":""},model:{value:t.payment_option,callback:function(e){t.payment_option=e},expression:"payment_option"}},[a("q-tab",{class:"Bank Deposit"==t.payment_option?"text-primary":"text-grey",attrs:{name:"Bank Deposit",icon:"account_balance",label:"Bank Deposit"}}),a("q-tab",{class:"Online Payment"==t.payment_option?"text-primary":"text-grey",attrs:{name:"Online Payment",icon:"credit_card",label:"Online Payment"}})],1),a("q-tab-panels",{attrs:{animated:""},model:{value:t.payment_option,callback:function(e){t.payment_option=e},expression:"payment_option"}},[a("q-tab-panel",{attrs:{name:"Bank Deposit"}},[a("q-list",{attrs:{bordered:""}},[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(e){t.payment_type="Full Payment"}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-radio",{attrs:{val:"Full Payment",color:"primary"},model:{value:t.payment_type,callback:function(e){t.payment_type=e},expression:"payment_type"}})],1),a("q-item-section",[a("q-item-label",[t._v("Full Payment")]),a("q-item-label",{attrs:{caption:""}},[t._v("\n                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod\n                  tempor incididunt ut labore et dolore magna aliqua.\n                ")])],1)],1),a("q-separator"),a("q-item",{attrs:{clickable:t.enable_layaway_dp,disable:!t.enable_layaway_dp,"v-ripple":t.enable_layaway_dp},on:{click:function(e){t.payment_type="20% Downpayment"}}},[a("q-item-section",{attrs:{avatar:""}},[t.enable_layaway_dp?a("q-radio",{attrs:{val:"20% Downpayment",color:"primary"},model:{value:t.payment_type,callback:function(e){t.payment_type=e},expression:"payment_type"}}):t._e()],1),a("q-item-section",[a("q-item-label",[t._v("20% Downpayment")]),a("q-item-label",{attrs:{caption:""}},[t._v("\n                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod\n                  tempor incididunt ut labore et dolore magna aliqua.\n                ")])],1)],1),a("q-separator"),a("q-item",{attrs:{clickable:t.enable_layaway_dp,disable:!t.enable_layaway_dp,"v-ripple":t.enable_layaway_dp},on:{click:function(e){t.payment_type="Layaway"}}},[a("q-item-section",{attrs:{avatar:""}},[t.enable_layaway_dp?a("q-radio",{attrs:{val:"Layaway",color:"primary"},model:{value:t.payment_type,callback:function(e){t.payment_type=e},expression:"payment_type"}}):t._e()],1),a("q-item-section",[a("q-item-label",[t._v("Layaway")]),a("q-item-label",{attrs:{caption:""}},[t._v("\n                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod\n                  tempor incididunt ut labore et dolore magna aliqua.\n                ")])],1)],1)],1),a("br"),a("div",{attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"Proceed"},on:{click:t.bankDeposit}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{flat:"",color:"primary",label:"Back"},on:{click:function(e){t.step=2}}})],1)],1),a("q-tab-panel",{attrs:{name:"Online Payment"}},[a("q-list",{attrs:{bordered:""}},[a("q-item",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{clickable:""},on:{click:function(e){t.payment_type="Full Payment"}}},[a("q-item-section",{attrs:{avatar:""}},[a("q-radio",{attrs:{val:"Full Payment",color:"primary"},model:{value:t.payment_type,callback:function(e){t.payment_type=e},expression:"payment_type"}})],1),a("q-item-section",[a("q-item-label",[t._v("Full Payment")]),a("q-item-label",{attrs:{caption:""}},[t._v("\n                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod\n                  tempor incididunt ut labore et dolore magna aliqua.\n                ")])],1)],1),a("q-separator"),a("q-item",{attrs:{clickable:t.enable_layaway_dp,disable:!t.enable_layaway_dp,"v-ripple":t.enable_layaway_dp},on:{click:function(e){t.payment_type="20% Downpayment"}}},[a("q-item-section",{attrs:{avatar:""}},[t.enable_layaway_dp?a("q-radio",{attrs:{val:"20% Downpayment",color:"primary"},model:{value:t.payment_type,callback:function(e){t.payment_type=e},expression:"payment_type"}}):t._e()],1),a("q-item-section",[a("q-item-label",[t._v("20% Downpayment")]),a("q-item-label",{attrs:{caption:""}},[t._v("\n                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod\n                  tempor incididunt ut labore et dolore magna aliqua.\n                ")])],1)],1),a("q-separator"),a("q-item",{attrs:{clickable:t.enable_layaway_dp,disable:!t.enable_layaway_dp,"v-ripple":t.enable_layaway_dp},on:{click:function(e){t.payment_type="Layaway"}}},[a("q-item-section",{attrs:{avatar:""}},[t.enable_layaway_dp?a("q-radio",{attrs:{val:"Layaway",color:"primary"},model:{value:t.payment_type,callback:function(e){t.payment_type=e},expression:"payment_type"}}):t._e()],1),a("q-item-section",[a("q-item-label",[t._v("Layaway")]),a("q-item-label",{attrs:{caption:""}},[t._v("\n                  Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod\n                  tempor incididunt ut labore et dolore magna aliqua.\n                ")])],1)],1)],1),a("br"),a("div",{staticClass:"row"},[a("AltPayNet",{attrs:{onlinePaymentResult:t.onlinePaymentResult,preparePayment:t.preparePayment}}),a("q-btn",{staticClass:"q-ml-sm",attrs:{flat:"",color:"primary",label:"Back"},on:{click:function(e){t.step=2}}})],1)],1)],1)],1),a("q-step",{attrs:{name:4,title:"Transaction Receipt",icon:"receipt"}},[a("q-stepper-navigation",[a("ServiceDetails",{attrs:{order:t.cart,buttonVisible:!1}}),a("div",{staticClass:"text-grey q-pr-sm",attrs:{align:"right"}},[t._v("Payment Method: "+t._s(t.payment_option))]),a("q-markup-table",{attrs:{flat:""}},[a("thead",[a("tr",[a("th",{staticClass:"text-left"},[t._v("Description")]),a("th",{staticClass:"text-right"},[t._v("Amount")])])]),a("tbody",[t._l(t.payment.breakdown,function(e){return a("tr",{key:e.description},[a("td",{staticClass:"text-left"},[t._v(t._s(e.description))]),a("td",{staticClass:"text-right"},[t._v(t._s(t.$prettyMoney(e.amount)))])])}),a("tr",[a("td",{staticClass:"text-left text-bold"},[t._v("TOTAL")]),a("td",{staticClass:"text-right text-bold"},[t._v(t._s(t.$prettyMoney(t.payment.total)))])])],2)]),a("div",{staticClass:"q-pt-sm",attrs:{align:"right"}},[a("q-btn",{attrs:{color:"primary",label:"Finish"},on:{click:function(e){return t.$router.push("/Reservations")}}})],1)],1)],1)],1)],1)},i=[],s=(a("6762"),a("2fdb"),a("a34a")),r=a.n(s),o=(a("7514"),a("96cf"),a("c973")),c=a.n(o),l=a("06a3"),p=a("2b67"),d={components:{AltPayNet:l["a"],ServiceDetails:p["a"]},props:["order"],data:function(){return{step:1,mode_of_delivery:"Shipping",primary_person_name:"",primary_contact_number:"",secondary_person_name:"",secondary_contact_number:"",payment_option:"Bank Deposit",payment_type:"Full Payment",country:"Philippines",house_bldg_st:"",barangay_district:"",city_municipality:"",state_province:"",zip_code:"",user:{},service:{},payment:{},cart:{},store:{},delivery_fee:0,enable_layaway_dp:!0,payment_utilities:{}}},methods:{preparePayment:function(){var t=[],e=0;return t.push({description:"Service",amount:(""!=this.service.sale_price?this.service.sale_price:this.service.regular_price)*this.cart.quantity}),t.push({description:"Convinience Fee",amount:this.payment_utilities.web_service_fee}),t.push({description:"Fuel/Transportation Fee",amount:this.delivery_fee}),t.map(function(t){e+=parseInt(t.amount)}),"Full Payment"==this.payment_type?this.prepareFullPayment(t,e):"20% Downpayment"==this.payment_type?this.prepareDownpayment(t,e):"Layaway"==this.payment_type&&this.prepareLayaway(t,e),this.payment},prepareFullPayment:function(t,e){this.payment={shopper_id:this.$local.getItem("user_token"),related_id:"",breakdown:t,total:e,payment_option:this.payment_option,payment_type:"Full Payment",payment_details:{},status:"Pending",type:"Service",payment_utilities:this.payment_utilities,regular_price:this.service.regular_price,sale_price:this.service.sale_price}},prepareDownpayment:function(t,e){this.payment={shopper_id:this.$local.getItem("user_token"),related_id:"",breakdown:t,total:e,payment_option:this.payment_option,payment_type:"20% Downpayment",registration_id:"",recurring_payments:[{schedule:"",amount:.2*e,payment_details:{},status:"Pending"},{schedule:this.$adjustDate(this.$subtractFromDate(this.cart.date_needed,14,0),0),amount:e-.2*e,payment_details:{},status:"Pending"}],status:"Pending",type:"Service",payment_utilities:this.payment_utilities,regular_price:this.service.regular_price,sale_price:this.service.sale_price}},prepareLayaway:function(t,e){var a=[],n=e,i=this.cart.date_needed,s=new Date,r=Math.ceil(this.$getDateDiff(i,s,"days")/30);a.push({schedule:"",amount:n/r,payment_details:{},status:"Pending"});for(var o=1;o<r-1;o++)a.push({schedule:this.$addToDate(s,30*o,0),amount:n/r,payment_details:{},status:"Pending"});a.push({schedule:this.$subtractFromDate(i,14,0),amount:n/r,payment_details:{},status:"Pending"}),this.payment={shopper_id:this.$local.getItem("user_token"),related_id:"",breakdown:t,total:e,payment_option:this.payment_option,payment_type:"Layaway",registration_id:"",recurring_payments:a,status:"Pending",type:"Service",payment_utilities:this.payment_utilities,regular_price:this.service.regular_price,sale_price:this.service.sale_price},console.log(this.payment)},onlinePaymentFullPayment:function(){var t=c()(r.a.mark(function t(){var e,a=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.cart.logs=[{event:"Ordered",date:new Date}],this.cart.status="For Acknowledgement",t.next=4,this.$dbCon.service("service-transactions").find({}).then(function(t){a.cart.order_number=t.total+1});case 4:return this.cart.mode_of_delivery=this.mode_of_delivery,this.cart.primary_person_name=this.primary_person_name,this.cart.primary_contact_number=this.primary_contact_number,this.cart.secondary_person_name=this.secondary_contact_number,this.cart.secondary_contact_number=this.secondary_contact_number,t.next=11,this.$dbCon.service("service-transactions").create(this.cart);case 11:return e=t.sent,this.payment.related_id=e._id,t.next=15,this.$dbCon.service("shopper-payments").create(this.payment);case 15:t.sent,this.$dbCon.service("cart").remove(this.cart._id);case 17:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),onlinePaymentDownpayment:function(){var t=c()(r.a.mark(function t(){var e,a=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.cart.logs=[{event:"Ordered",date:new Date}],this.cart.status="Pending Payment",t.next=4,this.$dbCon.service("service-transactions").find({}).then(function(t){a.cart.order_number=t.total+1});case 4:return this.cart.mode_of_delivery=this.mode_of_delivery,this.cart.primary_person_name=this.primary_person_name,this.cart.primary_contact_number=this.primary_contact_number,this.cart.secondary_person_name=this.secondary_contact_number,this.cart.secondary_contact_number=this.secondary_contact_number,t.next=11,this.$dbCon.service("service-transactions").create(this.cart);case 11:return e=t.sent,this.payment.related_id=e._id,this.payment.recurring_payments[0].status="Done",t.next=16,this.$dbCon.service("shopper-payments").create(this.payment);case 16:t.sent,this.$dbCon.service("cart").remove(this.cart._id);case 18:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),onlinePaymentLayaway:function(){var t=c()(r.a.mark(function t(){var e,a=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.cart.logs=[{event:"Ordered",date:new Date}],this.cart.status="Pending Payment",t.next=4,this.$dbCon.service("service-transactions").find({}).then(function(t){a.cart.order_number=t.total+1});case 4:return this.cart.mode_of_delivery=this.mode_of_delivery,this.cart.primary_person_name=this.primary_person_name,this.cart.primary_contact_number=this.primary_contact_number,this.cart.secondary_person_name=this.secondary_contact_number,this.cart.secondary_contact_number=this.secondary_contact_number,t.next=11,this.$dbCon.service("service-transactions").create(this.cart);case 11:return e=t.sent,this.payment.related_id=e._id,this.payment.recurring_payments[0].status="Done",t.next=16,this.$dbCon.service("shopper-payments").create(this.payment);case 16:t.sent,this.$dbCon.service("cart").remove(this.cart._id);case 18:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),onlinePaymentResult:function(){var t=c()(r.a.mark(function t(e,a){return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(console.log("INFO",a),console.log("RESULT",e),"success"!=e){t.next=30;break}if(this.step=4,"Full Payment"!=this.payment_type){t.next=11;break}return this.payment.status="Done",this.payment.payment_details=a,t.next=9,this.onlinePaymentFullPayment();case 9:t.next=27;break;case 11:if("20% Downpayment"!=this.payment_type){t.next=20;break}return this.payment.recurring_payments[0].schedule=new Date,this.payment.recurring_payments[0].payment_details=a,this.payment.registration_id=a.registrationId,this.payment.status="Pending",t.next=18,this.onlinePaymentDownpayment();case 18:t.next=27;break;case 20:if("Layaway"!=this.payment_type){t.next=27;break}return this.payment.recurring_payments[0].schedule=new Date,this.payment.recurring_payments[0].payment_details=a,this.payment.registration_id=a.registrationId,this.payment.status="Pending",t.next=27,this.onlinePaymentLayaway();case 27:this.$q.dialog({title:"Payment Accepted!",message:e}),t.next=31;break;case 30:this.$q.dialog({title:"Payment Rejected!",message:a.result.description});case 31:case"end":return t.stop()}},t,this)}));function e(e,a){return t.apply(this,arguments)}return e}(),bankDeposit:function(){var t=c()(r.a.mark(function t(){var e,a=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return console.log(this.preparePayment()),this.payment.deposit_details=[],"Full Payment"==this.payment_type?this.payment.deadline=this.$addToDate(new Date,2,0):"20% Downpayment"==this.payment_type?this.payment.recurring_payments[0].schedule=this.$addToDate(new Date,2,0):"Layaway"==this.payment_type&&(this.payment.recurring_payments[0].schedule=this.$addToDate(new Date,2,0)),this.cart.logs=[{event:"Ordered",date:new Date}],this.cart.status="Pending Payment",t.next=7,this.$dbCon.service("service-transactions").find({}).then(function(t){a.cart.order_number=t.total+1});case 7:return this.cart.mode_of_delivery=this.mode_of_delivery,this.cart.primary_person_name=this.primary_person_name,this.cart.primary_contact_number=this.primary_contact_number,this.cart.secondary_person_name=this.secondary_contact_number,this.cart.secondary_contact_number=this.secondary_contact_number,t.next=14,this.$dbCon.service("service-transactions").create(this.cart);case 14:return e=t.sent,this.payment.related_id=e._id,t.next=18,this.$dbCon.service("shopper-payments").create(this.payment);case 18:return t.sent,this.$dbCon.service("cart").remove(this.cart._id),t.next=22,this.reserveSchedule();case 22:this.step=4;case 23:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),reserveSchedule:function(){var t=c()(r.a.mark(function t(){var e;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e={},t.next=3,this.$dbCon.service("store-schedule").find({query:{store_id:this.store._id}}).then(function(t){e=t.data[0]});case 3:return console.log("1",e),e.schedules.push({date:this.cart.date_needed,status:0,remarks:"RESERVATION-"+this.cart.order_number}),console.log("2",e),console.log("STOREEE",e),t.next=9,this.$dbCon.service("store-schedule").patch(e._id,e);case 9:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},mounted:function(){var t=c()(r.a.mark(function t(){var e=this;return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.$dbCon.service("payment-utilities").find({}).then(function(t){e.payment_utilities=t.data[0]}),t.next=3,this.$getUser();case 3:return this.user=t.sent,t.next=6,this.$dbCon.service("cart").get(this.$route.params.cart).then(function(t){e.cart=t,e.$dbCon.service("services").get(t.item_id).then(function(t){e.service=t})}).catch(function(t){e.$router.push("/Orders")});case 6:return t.next=8,this.$dbCon.service("store").get(this.cart.store_id);case 8:this.store=t.sent,this.store.market_areas.includes(this.user.address.city_municipality)?(this.house_bldg_st=this.user.address.house_bldg_st,this.barangay_district=this.user.address.barangay_district,this.city_municipality=this.user.address.city_municipality,this.state_province=this.user.address.state_province,this.zip_code=this.user.address.zip_code):this.city_municipality=this.store.market_areas[0],this.enable_layaway_dp=this.$getDateDiff(this.cart.date_needed,this.$addToDate(new Date,5,0),"months")>=3;case 11:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),watch:{city_municipality:function(){var t=c()(r.a.mark(function t(){return r.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$getDeliveryTranspoFee(this.store._id,this.city_municipality,"fuel_transpo");case 2:this.delivery_fee=t.sent;case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()}},u=d,m=a("2877"),y=Object(m["a"])(u,n,i,!1,null,null,null);e["default"]=y.exports}}]);